some edits on 3rd-branch